# KPI Definition

## 1. KPI 개요

본 문서는 배달의민족(배민) 스타일의 배달 주문 이벤트 로그 분석 시스템에서
사용되는 **핵심 KPI(Key Performance Indicator)**를 정의한다.

KPI는 배달 주문 흐름에서 발생하는 이벤트 로그를 기반으로 계산되며,
운영 상태를 정량적으로 파악하고 병목 구간을 식별하는 것을 목적으로 한다.

---

## 2. 배달 주문 이벤트 흐름 정의

본 프로젝트에서는 하나의 주문(`order_id`)이 아래와 같은 흐름으로 처리된다고 가정한다.

```
주문 생성
→ 가게 접수
→ 조리 시작
→ 조리 완료
→ 라이더 배차
→ 픽업
→ 배달 완료
```

이를 분석을 위해 다음과 같은 **구간(Segment)** 으로 분리한다.

| 구간 코드 | 구간 설명               |
| --------- | ----------------------- |
| S1        | 주문 생성 → 가게 접수   |
| S2        | 가게 접수 → 조리 시작   |
| S3        | 조리 시작 → 조리 완료   |
| S4        | 조리 완료 → 라이더 배차 |
| S5        | 라이더 배차 → 픽업      |
| S6        | 픽업 → 배달 완료        |

---

## 3. 핵심 KPI (MVP 필수)

### KPI 1. 전체 배달 리드타임 (Total Delivery Lead Time)

**설명**  
고객이 주문을 생성한 시점부터 배달이 완료될 때까지의 총 소요 시간

**계산식**

```
배달 완료 시각 - 주문 생성 시각
```

**활용 목적**

-   전체 서비스 처리 속도 측정
-   SLA 기준 설정 및 지연 여부 판단

---

### KPI 2. 구간별 평균 리드타임 (Average Segment Lead Time)

**설명**  
배달 과정의 각 구간별 평균 소요 시간

**계산식**

```
(전체 리드타임 > SLA 기준) 주문 수 / 전체 주문 수
```

**활용 목적**

-   시간대, 지역, 가게별 서비스 품질 비교
-   운영 개선 우선순위 도출

---

### KPI 4. 병목 구간 Top N

**설명**  
각 주문에서 가장 오래 소요된 구간을 기준으로 집계한 병목 구간 통계

**계산 로직**

```
각 주문의 S1~S6 중 최대 소요 구간
```

**활용 목적**

-   지연의 주요 원인 파악
-   프로세스 개선 방향 도출

---

## 4. 운영 관점 KPI (확장 지표)

### KPI 5. 가게별 평균 조리 시간

**계산 구간**

```
조리 시작 → 조리 완료 (S3)
```

**활용 목적**

-   조리 지연 가게 식별
-   가게 운영 품질 관리

---

### KPI 6. 라이더 대기 시간

**계산 구간**

```
라이더 배차 → 픽업 (S5)
```

**활용 목적**

-   라이더 공급 부족 지역/시간대 파악
-   피크타임 대응 전략 수립

---

### KPI 7. 시간대별 주문 처리 성능

**분석 기준**

-   주문 생성 시각 기준 시간대 그룹핑

**출력 예시**
| 시간대 | 평균 리드타임 | 지연 주문 비율 |
|------|--------------|---------------|
| 11~13 | 48분 | 22% |
| 18~20 | 55분 | 35% |

---

## 5. KPI 계산을 위한 최소 데이터 요구사항

모든 KPI 계산을 위해 이벤트 로그에는 최소한 다음 정보가 포함되어야 한다.

-   `order_id`
-   `event_type`
-   `event_time`
-   `store_id`
-   `region`
-   `created_date`
-   `rider_id` (선택)

해당 요구사항은 이후 정의될 `data-schema.md`의 기준이 된다.

---

## 6. KPI 우선순위 정의

### 1차 구현 (MVP 필수)

-   전체 배달 리드타임
-   구간별 평균 리드타임
-   지연 주문 비율
-   병목 구간 Top N

### 2차 확장 (선택)

-   가게별 평균 조리 시간
-   라이더 대기 시간
-   시간대별 주문 처리 성능

---
